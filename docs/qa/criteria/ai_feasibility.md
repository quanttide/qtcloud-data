# AI 可行性审计规则

## 规则描述

评估开发计划是否适合 AI 助手执行，考虑 AI 的上下文能力、任务复杂度、依赖关系等因素。

---

## 1. 任务粒度合适

**规则描述**：单个任务不能过大，否则超出 AI 的上下文窗口或导致质量下降。

**判断标准**：
- 单个任务预计工时 ≤ 2 小时：优秀
- 单个任务预计工时 2-4 小时：警告
- 单个任务预计工时 > 4 小时：不合规

**检测方法**：
```bash
# 检查开发计划中的任务工时
grep -E "预计工时.*[0-9]+h" plan.md
```

**示例**：
```markdown
# ❌ 任务过大
TASK_001: 实现领域模型
预计工时: 8h

# ✅ 任务合适
TASK_001: 实现 Workspace 类
预计工时: 2h
TASK_002: 实现 BusinessArtifacts 类
预计工时: 2h
```

---

## 2. 上下文依赖明确

**规则描述**：任务之间的依赖关系必须明确，避免 AI 在不完整上下文中执行任务。

**判断标准**：
- 有依赖关系的任务必须标注前置任务
- 无依赖关系的任务可以并行执行
- 循环依赖：不合规

**检测方法**：
- 人工审查开发计划中的依赖关系

**示例**：
```markdown
# ❌ 依赖关系不明确
TASK_001: 实现领域模型
TASK_002: 重构测试

# ✅ 依赖关系明确
TASK_001: 实现领域模型
依赖: 无
TASK_002: 重构测试
依赖: TASK_001（需要领域模型先完成）
```

---

## 3. 交付物可验证

**规则描述**：每个任务的交付物必须有明确的验证标准，避免 AI 产出模糊结果。

**判断标准**：
- 每个任务有明确的交付物列表
- 交付物有验证标准（测试、检查清单等）

**检测方法**：
- 检查每个任务是否有"交付物"或"验收标准"部分

**示例**：
```markdown
# ❌ 交付物不明确
TASK_001: 实现领域模型

# ✅ 交付物明确
TASK_001: 实现 Workspace 类
交付物:
- src/domain/workspace.py
- tests/test_domain/test_workspace.py
验收标准:
- 所有单元测试通过
- 通过 pylint 检查
```

---

## 4. 输入数据完整

**规则描述**：任务执行所需的输入数据、文档、代码必须完整存在。

**判断标准**：
- 任务依赖的文档或代码已存在
- 或任务前序任务的交付物已可用

**检测方法**：
- 人工审查任务依赖的文件是否存在

**示例**：
```markdown
# ❌ 输入数据不完整
TASK_001: 实现领域模型
参考设计: docs/design/domain_models.md  # 文件不存在

# ✅ 输入数据完整
TASK_001: 实现 Workspace 类
参考设计: docs/design/domain_models.md  # 文件已存在
依赖: TASK_000（设计领域模型）
```

---

## 5. 任务边界清晰

**规则描述**：任务之间的边界必须清晰，避免任务重叠或范围模糊。

**判断标准**：
- 每个任务有明确的职责范围
- 不同任务的职责不重叠
- 任务名称能直接反映其范围

**检测方法**：
- 人工审查任务名称和描述

**示例**：
```markdown
# ❌ 任务边界不清晰
TASK_001: 实现领域模型
TASK_002: 重构代码

# ✅ 任务边界清晰
TASK_001: 实现 Workspace 类
范围: 仅涉及 Workspace 类的实现
TASK_002: 实现 BusinessArtifacts 类
范围: 仅涉及 BusinessArtifacts 类的实现
```

---

## 6. 并行任务可识别

**规则描述**：无依赖关系的任务应标注为可并行执行，提高效率。

**判断标准**：
- 无依赖关系的任务明确标注"可并行"
- 或通过依赖关系图体现

**检测方法**：
- 人工审查依赖关系，识别可并行的任务

**示例**：
```markdown
# ❌ 未识别并行任务
TASK_001: 实现 Workspace 类
TASK_002: 实现 BusinessArtifacts 类
TASK_003: 实现 DataPipeline 类

# ✅ 识别并行任务
TASK_001: 实现 Workspace 类
依赖: 无
TASK_002: 实现 BusinessArtifacts 类
依赖: 无
TASK_003: 实现 DataPipeline 类
依赖: 无
说明: TASK_001, TASK_002, TASK_003 可并行执行
```

---

## 7. 风险提示明确

**规则描述**：对 AI 可能遇到的困难或不确定性的任务，应标注风险提示。

**判断标准**：
- 复杂任务有风险说明
- 有风险缓解措施

**检测方法**：
- 检查开发计划中的风险部分

**示例**：
```markdown
# ❌ 无风险提示
TASK_001: 重构测试

# ✅ 有风险提示
TASK_001: 重构测试
风险: 测试重构可能导致测试失败
缓解措施:
- 逐步重构，每次只重构一个类
- 每次重构后立即运行测试
- 保持 Git 版本控制
```

---

## 规则检查清单

在评估开发计划的 AI 可行性时，请使用以下检查清单：

### 基础要求（必须满足）
- [ ] 单个任务预计工时 ≤ 2 小时
- [ ] 任务之间的依赖关系明确
- [ ] 每个任务有明确的交付物
- [ ] 任务依赖的输入数据完整
- [ ] 任务边界清晰，不重叠

### 推荐要求（建议满足）
- [ ] 可并行的任务已识别
- [ ] 复杂任务有风险提示和缓解措施

---

## 规则成熟度

**阶段 1（基础）**：任务粒度 + 边界清晰
**阶段 2（可用）**：阶段 1 + 依赖关系 + 交付物
**阶段 3（完善）**：阶段 2 + 并行识别 + 风险提示

---

## 规则层级
**通用规则** - 适用于所有开发计划
